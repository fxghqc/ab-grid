var ABGrid;!function(t){var i=function(){function t(){this.newRows=[],this.dirtyCells=[]}return t.prototype.whenRowAdded=function(t){this.isDirty=!0,this.hasNewRow=!0,this.newRows.push(t)},t.prototype.whenRowsRemoved=function(t){_.remove(this.newRows,function(i){return i===t}),_.remove(this.dirtyCells,function(i){return i.data===t}),this.newRows.length<1&&(this.hasNewRow=!1)},t.prototype.whenEdited=function(){this.isDirty=!0},t.prototype.dirtyCell=function(t,i){this.dirtyCells.push({colDef:t,data:i})},t.prototype.isDirtyCell=function(t,i){var e=_.findIndex(this.dirtyCells,{colDef:t,data:i});return e>=0},t}();t.GridStatus=i}(ABGrid||(ABGrid={}));var ABGrid;!function(t){var i=function(){function t(t){this.$window=t}return t.prototype.initialize=function(t){void 0===this.isPerfect&&this.$window.navigator.userAgent.indexOf("Mac")>=0&&(this.isPerfect=!0),this.isPerfect||this.$window.Ps.initialize(t)},t}();t.PsUtils=i}(ABGrid||(ABGrid={}));var ABGrid;!function(t){var i=function(){function t(t,i){this.$timeout=t,this.$window=i}return t.prototype.selectEditor=function(t){var i=this.$window.document.createElement("select"),e=this.$window.document.createElement("option");return e.setAttribute("value",""),e.innerHTML="-- 请选择 --",i.appendChild(e),t.forEach(function(t){var e=this.$window.document.createElement("option");e.setAttribute("value",t),e.innerHTML=t,i.appendChild(e)}),i.className="ag-cell-edit-select",i},t.prototype.resizeGrid=function(t,i){var e=this;this.$timeout(function(){t.sizeColumnsToFit(),i(),e.$timeout(function(){t.sizeColumnsToFit(),i()},10)})},t}();t.GridService=i}(ABGrid||(ABGrid={}));var ABGrid;!function(t){var i=angular.module("ABGrid",[]),e=function(){function t(t,i){var e=this;this.$log=t,this.PsUtils=i,this.restrict="E",this.transclude=!0,this.replace=!1,this.controller="ABGridCtrl",this.controllerAs="grid",this.scope={options:"=",status:"=",showFooter:"=",abSize:"@",name:"@"},this.link=function(t,i,r){switch(e.$log.debug("init perfect scrollbar"),e.PsUtils.initialize(i[0].firstChild.querySelector(".ab-grid .ag-body-viewport")),r.abSize){case"small":i.addClass("ab-sm")}},this.template='<div class="panel panel-default ab-grid"><div class="panel-heading" ng-transclude></div><div class="panel-body"><div ag-grid="options" class="ag-fresh ag-noborder"></div></div><div class="panel-footer text-center" ng-show="showFooter"></div></div>'}return t}();t.ABGridDirective=e;var r=function(){function t(){this.require="^abGrid",this.restrict="E",this.transclude=!0,this.replace=!0,this.template='<div class="panel-heading-title" ng-transclude></div>'}return t}();t.ABGridTtile=r;var o=function(){function t(t){var i=this;this.PsUtils=t,this.require="^abGrid",this.restrict="E",this.transclude=!0,this.replace=!0,this.controller="ABGridToolboxCtrl",this.link=function(t,e){var r=e[0].querySelector(".sencond-list");i.PsUtils.initialize(r)},this.template='<div class="panel-heading-toolbox" role="toolbar" aria-label="..."><div class="btn-group btn-group-sm" role="group" aria-label="..." ng-transclude></div><div class="btn-group btn-group-sm" dropdown keyboard-nav auto-close="outsideClick"><button id="simple-btn-keyboard-nav" type="button" class="btn btn-darkslategrey btn-clear" dropdown-toggle>settings <span class="caret"></span></button><ul class="dropdown-menu" role="menu" aria-labelledby="simple-btn-keyboard-nav"><li role="menuitem" ng-mouseenter="showColumns = true" ng-mouseleave="showColumns"><a href="#">Columns</a><ul class="list-group sencond-list" ng-show="showColumns"><li class="list-group-item" ng-repeat="col in $parent.options.columnDefs"><div class="checkbox"><label><input type="checkbox" ng-model="col.show" ng-change="abChanged(col)"> {{col.headerName}}</label></div></li></ul></li><li role="menuitem" ng-mouseenter="showColumns = false"><a href="#">Another</a></li><li role="menuitem" ng-mouseenter="showColumns = false"><a href="#">Something</a></li><li class="divider" ng-mouseenter="showColumns = false"></li><li role="menuitem" ng-mouseenter="showColumns = false"><a href="#">Separated</a></li></ul></div></div>'}return t}();t.ABGridToolbox=o;var n=function(){function t(){this.require="^abGridToolbox",this.restrict="E",this.transclude=!0,this.replace=!0,this.scope={clickFun:"&btnClick"},this.template='<button type="button" class="btn btn-darkslategrey btn-clear" ng-click="clickFun()" ng-transclude></button>'}return t}();t.ABGridToolboxBtn=n;var s=function(){function t(){this.require="^abGridToolbox",this.restrict="E",this.transclude=!0,this.replace=!0,this.template='<span class="toolbox-delimiter"></span>'}return t}();t.ABGridToolboxDelimiter=s;var l=function(){function t(){this.require="^abGrid",this.restrict="E",this.replace=!0,this.controller=function(t,i){i.debug(t.$parent.options)},this.template='<form class="form-inline pull-right"><div class="form-group form-group-ssm has-feedback" id="attr-search"><label class="control-label sr-only" for="baseFilterText">Hidden label</label><input ng-model="$parent.options.quickFilterText" type="search" class="form-control" id="baseFilterText" aria-describedby="sensorFilterTextStatus"><span class="glyphicon glyphicon-search form-control-feedback" aria-hidden="true"></span><span id="sensorFilterTextStatus" class="sr-only">(success)</span></div></form>'}return t}();t.ABGridSearch=l;var a=function(){function t(t,i,e){this.$scope=t,this.GridStatus=i,this.$timeout=e;var r=new this.GridStatus,o=t.name;t.options.columnDefs.forEach(function(t){var i=localStorage.getItem("ab-grid-col-"+o+"-"+t.field+"-show");switch(i){case"true":t.show=!0;break;case"false":t.show=!1,t.hide=!0;break;default:t.show=!0}}),e(function(){t.options.api.status=r})}return t}();t.ABGridCtrl=a;var c=function(){function t(t,i){var e=this;this.$scope=t,this.$timeout=i;var r=t.$parent.name;t.showColumns=!1,t.abChanged=function(i){i.hide=!i.show,localStorage.setItem("ab-grid-col-"+r+"-"+i.field+"-show",i.show),e.$timeout(function(){t.$parent.options.columnApi.hideColumn(i.field,i.hide)})}}return t}();t.ABGridToolboxCtrl=c,i.controller("ABGridCtrl",["$scope","GridStatus","$timeout",t.ABGridCtrl]),i.controller("ABGridToolboxCtrl",["$scope","$timeout",t.ABGridToolboxCtrl]),i.factory("PsUtils",["$window",function(i){return new t.PsUtils(i)}]),i.factory("GridStatus",[function(){return t.GridStatus}]),i.factory("ABGrid",["$timeout","$window",function(i,e){return new t.GridService(i,e)}]),i.directive("abGrid",["$log","PsUtils",function(i,e){return new t.ABGridDirective(i,e)}]),i.directive("abGridTitle",[function(){return new t.ABGridTtile}]),i.directive("abGridToolbox",["PsUtils",function(i){return new t.ABGridToolbox(i)}]),i.directive("abGridToolboxBtn",[function(){return new t.ABGridToolboxBtn}]),i.directive("abGridToolboxDelimiter",[function(){return new t.ABGridToolboxDelimiter}]),i.directive("abGridSearch",[function(){return new t.ABGridSearch}])}(ABGrid||(ABGrid={}));var ABGrid;!function(t){var i=function(){function t(t,i,e){this.$log=t,this._=i,this.GridErrorProxy=e}return t.prototype.compareValue=function(t,i,e){},t.prototype.notNullValidation=function(t){var i=t.colDef.field,e=t.colDef.headerName,r=t.newValue,o=_.isEmpty(r),n=t.api;n.status.dirtyCell(t.colDef,t.data),o?(this.GridErrorProxy.addError(t.data,i,e,"不能为空"),n.scope.$apply()):(this.GridErrorProxy.removeError(t.data,i),n.scope.$apply()),n.refreshView()},t}();t.GridValidation=i}(ABGrid||(ABGrid={}));